<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FutureRent API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="./assets/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#3b82f6',
              secondary: '#1e40af',
              accent: '#10b981',
            },
          },
        },
      };
    </script>
    <style>
      .code-block {
        background-color: #1a202c;
        color: #e2e8f0;
        border-radius: 0.5rem;
        padding: 1rem;
        font-family: 'Courier New', monospace;
        overflow-x: auto;
      }
      .endpoint-method {
        padding: 0.25rem 0.75rem;
        border-radius: 0.375rem;
        font-weight: 600;
        font-size: 0.875rem;
      }
      .method-get {
        background-color: #10b981;
        color: white;
      }
      .method-post {
        background-color: #3b82f6;
        color: white;
      }
      .method-put {
        background-color: #f59e0b;
        color: white;
      }
      .method-delete {
        background-color: #ef4444;
        color: white;
      }
      .method-patch {
        background-color: #8b5cf6;
        color: white;
      }

      .sidebar {
        position: sticky;
        top: 0;
        height: 100vh;
        overflow-y: auto;
      }

      .content-section {
        scroll-margin-top: 2rem;
      }

      .nav-link {
        transition: all 0.3s ease;
      }

      .nav-link:hover,
      .nav-link.active {
        background-color: #3b82f6;
        color: white;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="flex">
      <!-- Sidebar -->
      <div class="sidebar w-64 bg-white shadow-lg">
        <div class="p-6">
          <h1 class="text-2xl font-bold text-primary">FutureRent API</h1>
          <p class="text-gray-600 mt-2">Version: 2.0.0</p>
        </div>

        <nav class="mt-6">
          <ul class="space-y-2 px-4">
            <li>
              <a href="#overview" class="nav-link block p-2 rounded-md"
                >üìã Overview</a
              >
            </li>
            <li>
              <a href="#authentication" class="nav-link block p-2 rounded-md"
                >üîê Authentication</a
              >
            </li>
            <li>
              <a href="#endpoints" class="nav-link block p-2 rounded-md"
                >üîó Endpoints</a
              >
            </li>
            <li>
              <a href="#models" class="nav-link block p-2 rounded-md"
                >üìä Data Models</a
              >
            </li>
            <li>
              <a href="#middleware" class="nav-link block p-2 rounded-md"
                >‚öôÔ∏è Middleware</a
              >
            </li>
            <li>
              <a href="#utils" class="nav-link block p-2 rounded-md"
                >üõ†Ô∏è Utilities</a
              >
            </li>
            <li>
              <a href="#logging" class="nav-link block p-2 rounded-md"
                >üìù Logging System</a
              >
            </li>
            <li>
              <a href="#error-handling" class="nav-link block p-2 rounded-md"
                >‚ö†Ô∏è Error Handling</a
              >
            </li>
            <li>
              <a href="#examples" class="nav-link block p-2 rounded-md"
                >üí° Code Examples</a
              >
            </li>
          </ul>
        </nav>

        <div class="mt-8 px-4">
          <div class="bg-blue-50 p-4 rounded-lg">
            <h3 class="font-semibold text-blue-800">Quick Links</h3>
            <ul class="mt-2 space-y-1 text-sm">
              <li>
                <a href="#activity-logger" class="text-blue-600 hover:underline"
                  >Activity Logger</a
                >
              </li>
              <li>
                <a href="#auth-middleware" class="text-blue-600 hover:underline"
                  >Auth Middleware</a
                >
              </li>
              <li>
                <a href="#user-endpoints" class="text-blue-600 hover:underline"
                  >User Endpoints</a
                >
              </li>
              <li>
                <a
                  href="#property-endpoints"
                  class="text-blue-600 hover:underline"
                  >Property Endpoints</a
                >
              </li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="flex-1 p-8">
        <!-- Overview Section -->
        <section id="overview" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">API Overview</h2>
            <p class="text-gray-600 mb-4">
              FutureRent API is a comprehensive property management system built
              with Node.js, TypeScript, and Express. It provides endpoints for
              user management, property listings, rental agreements, and more.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
              <div class="bg-blue-50 p-4 rounded-lg">
                <i class="fas fa-server text-blue-500 text-2xl"></i>
                <h3 class="font-semibold mt-2">Tech Stack</h3>
                <ul class="mt-2 text-sm">
                  <li>Node.js & Express</li>
                  <li>TypeScript</li>
                  <li>Winston Logger</li>
                  <li>JWT Authentication</li>
                </ul>
              </div>

              <div class="bg-green-50 p-4 rounded-lg">
                <i class="fas fa-feather text-green-500 text-2xl"></i>
                <h3 class="font-semibold mt-2">Features</h3>
                <ul class="mt-2 text-sm">
                  <li>Comprehensive Logging</li>
                  <li>Role-based Access</li>
                  <li>RESTful API Design</li>
                  <li>Error Handling</li>
                </ul>
              </div>

              <div class="bg-purple-50 p-4 rounded-lg">
                <i class="fas fa-shield-alt text-purple-500 text-2xl"></i>
                <h3 class="font-semibold mt-2">Security</h3>
                <ul class="mt-2 text-sm">
                  <li>JWT Tokens</li>
                  <li>Input Validation</li>
                  <li>Secure Headers</li>
                  <li>Rate Limiting</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <!-- Authentication Section -->
        <section id="authentication" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">
              Authentication
            </h2>
            <p class="text-gray-600 mb-4">
              All protected endpoints require a valid JWT token in the
              Authorization header.
            </p>

            <div class="code-block mb-4">
              <pre><code>Authorization: Bearer &lt;your_jwt_token&gt;</code></pre>
            </div>

            <h3 class="text-xl font-semibold mt-6 mb-2">Authentication Flow</h3>
            <ol class="list-decimal list-inside space-y-2">
              <li>User sends login request with credentials</li>
              <li>Server validates credentials and returns JWT token</li>
              <li>
                Client includes token in Authorization header for subsequent
                requests
              </li>
              <li>Middleware validates token on each protected endpoint</li>
            </ol>
          </div>
        </section>

        <!-- Endpoints Section -->
        <section id="endpoints" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">API Endpoints</h2>

            <!-- User Endpoints -->
            <div id="user-endpoints" class="mb-8">
              <h3 class="text-2xl font-semibold mb-4 text-primary">
                User Management
              </h3>

              <div class="border rounded-lg overflow-hidden mb-4">
                <div class="bg-gray-100 p-3 flex justify-between items-center">
                  <span class="endpoint-method method-post">POST</span>
                  <span class="font-mono">/api/v1/auth/login</span>
                </div>
                <div class="p-4">
                  <p class="mb-2">Authenticate user and return JWT token.</p>
                  <div class="code-block text-sm">
                    <pre><code>{
  "email": "user@example.com",
  "password": "password123"
}</code></pre>
                  </div>
                </div>
              </div>

              <div class="border rounded-lg overflow-hidden mb-4">
                <div class="bg-gray-100 p-3 flex justify-between items-center">
                  <span class="endpoint-method method-post">POST</span>
                  <span class="font-mono">/api/v1/auth/register</span>
                </div>
                <div class="p-4">
                  <p class="mb-2">Register a new user account.</p>
                  <div class="code-block text-sm">
                    <pre><code>{
  "name": "John Doe",
  "email": "john@example.com",
  "password": "securepassword",
  "role": "tenant"
}</code></pre>
                  </div>
                </div>
              </div>

              <div class="border rounded-lg overflow-hidden mb-4">
                <div class="bg-gray-100 p-3 flex justify-between items-center">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="font-mono">/api/v1/users/profile</span>
                </div>
                <div class="p-4">
                  <p class="mb-2">
                    Get current user profile (requires authentication).
                  </p>
                </div>
              </div>
            </div>

            <!-- Property Endpoints -->
            <div id="property-endpoints" class="mb-8">
              <h3 class="text-2xl font-semibold mb-4 text-primary">
                Property Management
              </h3>

              <div class="border rounded-lg overflow-hidden mb-4">
                <div class="bg-gray-100 p-3 flex justify-between items-center">
                  <span class="endpoint-method method-get">GET</span>
                  <span class="font-mono">/api/v1/properties</span>
                </div>
                <div class="p-4">
                  <p class="mb-2">
                    Get list of properties with pagination and filtering.
                  </p>
                  <div class="code-block text-sm">
                    <pre><code>GET /api/v1/properties?page=1&limit=10&type=apartment</code></pre>
                  </div>
                </div>
              </div>

              <div class="border rounded-lg overflow-hidden mb-4">
                <div class="bg-gray-100 p-3 flex justify-between items-center">
                  <span class="endpoint-method method-post">POST</span>
                  <span class="font-mono">/api/v1/properties</span>
                </div>
                <div class="p-4">
                  <p class="mb-2">
                    Create a new property listing (requires landlord role).
                  </p>
                  <div class="code-block text-sm">
                    <pre><code>{
  "title": "Modern Apartment",
  "description": "Spacious 2-bedroom apartment...",
  "price": 1500,
  "type": "apartment",
  "location": {
    "address": "123 Main St",
    "city": "New York",
    "state": "NY"
  }
}</code></pre>
                  </div>
                </div>
              </div>
            </div>

            <!-- Additional endpoints would continue here -->
          </div>
        </section>

        <!-- Middleware Section -->
        <section id="middleware" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Middleware</h2>

            <div id="auth-middleware" class="mb-6">
              <h3 class="text-xl font-semibold mb-2">
                Authentication Middleware
              </h3>
              <p class="mb-3">
                Validates JWT tokens and attaches user data to requests.
              </p>
              <div class="code-block">
                <pre><code>import { Request, Response, NextFunction } from 'express';
import jwt from 'jsonwebtoken';

export const authMiddleware = (req: Request, res: Response, next: NextFunction) => {
    const token = req.header('Authorization')?.replace('Bearer ', '');
    
    if (!token) {
        return res.status(401).json({ error: 'Access denied. No token provided.' });
    }
    
    try {
        const decoded = jwt.verify(token, process.env.JWT_SECRET!);
        (req as any).user = decoded;
        next();
    } catch (error) {
        res.status(400).json({ error: 'Invalid token.' });
    }
};</code></pre>
              </div>
            </div>

            <div class="mb-6">
              <h3 class="text-xl font-semibold mb-2">
                Activity Logging Middleware
              </h3>
              <p class="mb-3">Logs all incoming requests and responses.</p>
              <div class="code-block">
                <pre><code>import { Request, Response, NextFunction } from 'express';
import ActivityLogger from '../utils/activityLogger';

export const activityLogMiddleware = (req: Request, res: Response, next: NextFunction) => {
    ActivityLogger.logRequest(req, res, next);
};

export const errorLogMiddleware = (error: any, req: Request, res: Response, next: NextFunction) => {
    ActivityLogger.logError(error, req, res);
    next(error);
};</code></pre>
              </div>
            </div>
          </div>
        </section>

        <!-- Utilities Section -->
        <section id="utils" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">
              Utility Functions
            </h2>

            <div id="activity-logger" class="mb-6">
              <h3 class="text-xl font-semibold mb-2">Activity Logger</h3>
              <p class="mb-3">
                Comprehensive logging utility for request/response tracking.
              </p>
              <div class="code-block">
                <pre><code>static logRequest(req: Request, res: Response, next: NextFunction): void {
    const startTime = Date.now();
    const logData = this.createLogData(req, res, startTime);

    // Check for authorization header
    const authHeader = req.headers['authorization'] || req.headers['Authorization'];
    if (!authHeader) {
        res.status(401).json({
            error: 'Access denied',
            message: 'Authorization header is required',
        });
        ActivityLogger.logError({
            message: 'Access denied - No authorization header provided',
            stack: "Auth Controller: Authorization header is required",
            name: "Auth Controller",
        }, req, res)
        return;
    }
    
    // Continue with request processing...
}</code></pre>
              </div>
            </div>

            <div class="mb-6">
              <h3 class="text-xl font-semibold mb-2">Response Helper</h3>
              <p class="mb-3">Standardized response format utility.</p>
              <div class="code-block">
                <pre><code>export class ResponseHelper {
    static success(res: Response, data: any, message: string = 'Success', statusCode: number = 200) {
        return res.status(statusCode).json({
            success: true,
            message,
            data
        });
    }
    
    static error(res: Response, message: string, statusCode: number = 500, errorDetails?: any) {
        return res.status(statusCode).json({
            success: false,
            message,
            error: errorDetails
        });
    }
}</code></pre>
              </div>
            </div>
          </div>
        </section>

        <!-- Logging System Section -->
        <section id="logging" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">
              Logging System
            </h2>

            <div class="mb-6">
              <h3 class="text-xl font-semibold mb-2">Log Files Structure</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-100 p-4 rounded">
                  <h4 class="font-semibold">activity.log</h4>
                  <p class="text-sm mt-2">
                    Normal request/response logging for successful operations.
                  </p>
                </div>
                <div class="bg-gray-100 p-4 rounded">
                  <h4 class="font-semibold">error.log</h4>
                  <p class="text-sm mt-2">
                    Error logging for failed requests and exceptions.
                  </p>
                </div>
                <div class="bg-gray-100 p-4 rounded">
                  <h4 class="font-semibold">app_control.log</h4>
                  <p class="text-sm mt-2">
                    Authorization and application control events.
                  </p>
                </div>
              </div>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-2">Log Entry Example</h3>
              <div class="code-block">
                <pre><code>{
  "logId": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "timestamp": "2023-10-05T12:00:00.000Z",
  "level": "info",
  "message": "GET /api/v1/users/profile",
  "requestId": "req-123456",
  "userId": "user-789",
  "ipAddress": "192.168.1.100",
  "userAgent": "Mozilla/5.0...",
  "method": "GET",
  "url": "/api/v1/users/profile",
  "headers": { "authorization": "***REDACTED***" },
  "responseStatus": 200,
  "responseTime": 45
}</code></pre>
              </div>
            </div>
          </div>
        </section>

        <!-- Error Handling Section -->
        <section id="error-handling" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">
              Error Handling
            </h2>

            <div class="mb-6">
              <h3 class="text-xl font-semibold mb-2">Custom Error Classes</h3>
              <div class="code-block">
                <pre><code>export class AppError extends Error {
    public statusCode: number;
    public isOperational: boolean;

    constructor(message: string, statusCode: number = 500) {
        super(message);
        this.statusCode = statusCode;
        this.isOperational = true;
        
        Error.captureStackTrace(this, this.constructor);
    }
}

export class ValidationError extends AppError {
    constructor(message: string, details?: any) {
        super(message, 400);
        this.name = 'ValidationError';
    }
}

export class AuthenticationError extends AppError {
    constructor(message: string = 'Authentication failed') {
        super(message, 401);
        this.name = 'AuthenticationError';
    }
}</code></pre>
              </div>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-2">Global Error Handler</h3>
              <div class="code-block">
                <pre><code>export const errorHandler = (err: any, req: Request, res: Response, next: NextFunction) => {
    // Log error
    ActivityLogger.logError(err, req, res);
    
    // Default error
    let error = { ...err };
    error.message = err.message;

    // Mongoose bad ObjectId
    if (err.name === 'CastError') {
        const message = 'Resource not found';
        error = new AppError(message, 404);
    }

    // Mongoose duplicate key
    if (err.code === 11000) {
        const message = 'Duplicate field value entered';
        error = new AppError(message, 400);
    }

    // Mongoose validation error
    if (err.name === 'ValidationError') {
        const message = Object.values(err.errors).map((val: any) => val.message);
        error = new AppError(message.join(', '), 400);
    }

    res.status(error.statusCode || 500).json({
        success: false,
        message: error.message || 'Server Error'
    });
};</code></pre>
              </div>
            </div>
          </div>
        </section>

        <!-- Code Examples Section -->
        <section id="examples" class="content-section mb-12">
          <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Code Examples</h2>

            <div class="mb-6">
              <h3 class="text-xl font-semibold mb-2">
                Complete Controller Example
              </h3>
              <div class="code-block">
                <pre><code>import { Request, Response } from 'express';
import { User } from '../models/User';
import { ResponseHelper } from '../utils/responseHelper';
import { AppError } from '../errors/AppError';
import ActivityLogger from '../utils/activityLogger';

export class UserController {
    static async getProfile(req: Request, res: Response) {
        try {
            const userId = (req as any).user.id;
            const user = await User.findById(userId).select('-password');
            
            if (!user) {
                throw new AppError('User not found', 404);
            }
            
            ActivityLogger.logAuthorizationEvent('GRANTED', 'User profile accessed', req, {
                userId: user.id,
                action: 'profile_view'
            });
            
            return ResponseHelper.success(res, user, 'Profile retrieved successfully');
        } catch (error) {
            ActivityLogger.logError(error, req, res);
            return ResponseHelper.error(res, 'Failed to retrieve profile', 500, error);
        }
    }
    
    static async updateProfile(req: Request, res: Response) {
        try {
            const userId = (req as any).user.id;
            const { name, email } = req.body;
            
            const user = await User.findByIdAndUpdate(
                userId,
                { name, email },
                { new: true, runValidators: true }
            ).select('-password');
            
            if (!user) {
                throw new AppError('User not found', 404);
            }
            
            ActivityLogger.logAppControlEvent('PROFILE_UPDATE', 'User profile updated', {
                userId: user.id,
                updatedFields: Object.keys(req.body)
            }, req);
            
            return ResponseHelper.success(res, user, 'Profile updated successfully');
        } catch (error) {
            ActivityLogger.logError(error, req, res);
            return ResponseHelper.error(res, 'Failed to update profile', 500, error);
        }
    }
}</code></pre>
              </div>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-2">Route Configuration</h3>
              <div class="code-block">
                <pre><code>import express from 'express';
import { UserController } from '../controllers/UserController';
import { authMiddleware } from '../middleware/authMiddleware';
import { activityLogMiddleware } from '../middleware/activityLogMiddleware';

const router = express.Router();

// Apply activity logging to all routes
router.use(activityLogMiddleware);

// Public routes
router.post('/auth/register', UserController.register);
router.post('/auth/login', UserController.login);

// Protected routes (require authentication)
router.use(authMiddleware);

router.get('/users/profile', UserController.getProfile);
router.put('/users/profile', UserController.updateProfile);

export default router;</code></pre>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <script>
      // Simple script to handle active navigation
      document.addEventListener('DOMContentLoaded', function () {
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.content-section');

        // Set first nav link as active
        navLinks[0].classList.add('active');

        // Update active nav link on scroll
        window.addEventListener('scroll', function () {
          let current = '';

          sections.forEach((section) => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (scrollY >= sectionTop - 100) {
              current = section.getAttribute('id');
            }
          });

          navLinks.forEach((link) => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current) {
              link.classList.add('active');
            }
          });
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
              target.scrollIntoView({
                behavior: 'smooth',
                block: 'start',
              });
            }
          });
        });
      });
    </script>
  </body>
</html>
